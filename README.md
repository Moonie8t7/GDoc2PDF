# GDoc2PDF
Converts all the Google Doc files in a folder and its child folders into PDFs
| | | | | | | | | | | | | | | | | | | | | | | | | | |
|-|-|-|-|-|-|-|-|-|-|-|-|-|-|-|-|-|-|-|-|-|-|-|-|-|-|
|tags| | | | | | | | | | |description| | |isPrivate|isConstructor|isClass|isEvent|ignore|line|codeStart|code|ctx| | | |
|type|string|html|types|description|name|typesDescription|variable|nonNullable|nullable|optional|full|summary|body| | | | | | | | |type|name|value|string|
|author|u/IAmMoonie <https://www.reddit.com/user/IAmMoonie/>|<p>u/IAmMoonie <a href="https://www.reddit.com/user/IAmMoonie/">https://www.reddit.com/user/IAmMoonie/</a></p>| | | | | | | | ||||FALSE|FALSE|FALSE|FALSE|FALSE|1|8| | | | | |
|file|https://www.reddit.com/r/GoogleAppsScript/comments/10p0mfm/automatic_conversion_of_gdocs_to_pdfs|<p>https://www.reddit.com/r/GoogleAppsScript/comments/10p0mfm/automatic_conversion_of_gdocs_to_pdfs</p>| | | | | | | | |<p>It's the ID of the folder you want to convert the files in.</p>|<p>It's the ID of the folder you want to convert the files in.</p>||FALSE|FALSE|FALSE|FALSE|FALSE|9|10|const FOLDER_ID = "your top level folder ID goes here";|declaration|FOLDER_ID|"your top level folder ID goes here"|FOLDER_ID|
|desc|Takes a parent folder, then iterates through it and its children and converts each Google Doc to a PDF in a new folder.|<p>Takes a parent folder, then iterates through it and its children and converts each Google Doc to a PDF in a new folder.</p>| | | | | | | | |<p>It's the number of files that will be converted at a time.</p>|<p>It's the number of files that will be converted at a time.</p>||FALSE|FALSE|FALSE|FALSE|FALSE|12|13|const BATCH_SIZE = 50;|declaration|BATCH_SIZE|50|BATCH_SIZE|
|throws|{Error} If an error occurs while getting the folder or converting the files to PDF|<p>MIT</p>|Error|<p>If an error occurs while getting the folder or converting the files to PDF</p>| | | | | | |<p>Gets all the files in the top folder, then it gets all the files in all the subfolders, then it<br /> converts all the files in the top folder and all the subfolders to PDF</p>|<p>Gets all the files in the top folder, then it gets all the files in all the subfolders, then it<br /> converts all the files in the top folder and all the subfolders to PDF</p>||FALSE|FALSE|FALSE|FALSE|FALSE|15|22|function convertToPDF() {   try {     const topFolder = DriveApp.getFolderById(FOLDER_ID);     convertFilesInFolder_(topFolder);   } catch (error) {     console.error(`Error: ${error.message}`);   } }|function|convertToPDF| |convertToPDF()|
|param|folder - The folder you want to convert the files in.|<p>convertToPDF();</p>| |<ul> <li>The folder you want to convert the files in.</li> </ul>|folder||FALSE|FALSE|FALSE|FALSE|<p>Takes a folder, checks if it's name contains "CONVERTED", if not, it gets all the Google Docs in<br /> the folder, creates a new folder with the name "CONVERTED" appended to the original folder name,<br /> then converts the Google Docs to PDFs and puts them in the new folder</p>|<p>Takes a folder, checks if it's name contains "CONVERTED", if not, it gets all the Google Docs in<br /> the folder, creates a new folder with the name "CONVERTED" appended to the original folder name,<br /> then converts the Google Docs to PDFs and puts them in the new folder</p>||FALSE|FALSE|FALSE|FALSE|FALSE|31|40|function convertFilesInFolder_(folder) {   try {     if (!folder.getName().includes("CONVERTED")) {       const docs = folder.getFilesByType(MimeType.GOOGLE_DOCS);       const docArray = [];       while (docs.hasNext()) {         docArray.push(docs.next());       }       const convertedFolder = createConvertedFolder_(folder);       for (let i = 0; i < docArray.length; i += BATCH_SIZE) {         const batch = docArray.slice(i, i + BATCH_SIZE);         Utilities.sleep(1000);         batch.map((doc) =>           createPDFfile_(doc.getId(), convertedFolder.getId())         );       }     }     const subFolders = folder.getFolders();     while (subFolders.hasNext()) {       const subFolder = subFolders.next();       convertFilesInFolder_(subFolder);     }   } catch (error) {     console.error(`Error: ${error.message}`);   } }|function|convertFilesInFolder_| |convertFilesInFolder_()|
|param|folder - The folder you want to convert.| |Error|<ul> <li>The folder you want to convert.</li> </ul>|folder||FALSE|FALSE|FALSE|FALSE|<p>Creates a folder named "folderName_CONVERTED" in the folder passed to the function.<br /> If the folder already exists, it returns the existing folder.</p>|<p>Creates a folder named "folderName_CONVERTED" in the folder passed to the function.<br /> If the folder already exists, it returns the existing folder.</p>||FALSE|FALSE|FALSE|FALSE|FALSE|67|77|function createConvertedFolder_(folder) {   try {     const folderName = `${getFileName_(folder.getName())}_CONVERTED`;     let convertedFolder;     const existingFolders = folder.getFoldersByName(folderName);     if (existingFolders.hasNext()) {       convertedFolder = existingFolders.next();     } else {       convertedFolder = folder.createFolder(folderName);     }     return convertedFolder;   } catch (error) {     console.error(`Error while creating converted folder: ${error.message}`);   } }|function|createConvertedFolder_| |createConvertedFolder_()|
|param|fileID - The ID of the file you want to convert to PDF.|<p>convertFilesInFolder_(DriveApp.getFolderById(FOLDER_ID))</p>| |<ul> <li>The ID of the file you want to convert to PDF.</li> </ul>|fileID||FALSE|FALSE|FALSE|FALSE|<p>Takes a file ID and a folder ID as parameters, and if the file is not already in the folder,<br /> create a PDF version of the file and move it to the folder. It also checks if the file is newer than<br /> the PDF file in the folder, it creates a new PDF file in the folder replacing the old PDF.</p>|<p>Takes a file ID and a folder ID as parameters, and if the file is not already in the folder,<br /> create a PDF version of the file and move it to the folder. It also checks if the file is newer than<br /> the PDF file in the folder, it creates a new PDF file in the folder replacing the old PDF.</p>||FALSE|FALSE|FALSE|FALSE|FALSE|93|103|function createPDFfile_(fileID, folderID) {   try {     const templateFile = DriveApp.getFileById(fileID);     const folder = DriveApp.getFolderById(folderID);     const fileName = `${getFileName_(templateFile.getName())}.pdf`;     let existingFile = folder.getFilesByName(fileName).hasNext()       ? folder.getFilesByName(fileName).next()       : null;     if (       existingFile &&       existingFile.getDateCreated().valueOf() >=         templateFile.getLastUpdated().valueOf()     ) {       return;     }     if (existingFile) {       existingFile.setTrashed(true);     }     const theBlob = templateFile.getBlob().getAs("application/pdf");     folder.createFile(theBlob).setName(fileName);     console.log(`Success: PDF created for file ${fileName}`);   } catch (error) {     console.error(       `Error while converting to PDF and moving to folder: ${error.message}`     );   } }|function|createPDFfile_| |createPDFfile_()|
|param|fileName - The name of the file you want to get the name of.| |Error|<ul> <li>The name of the file you want to get the name of.</li> </ul>|fileName||FALSE|FALSE|FALSE|FALSE|<p>Takes a string, finds the last period in the string, and returns the string without the last<br /> period and everything after it.</p>|<p>Takes a string, finds the last period in the string, and returns the string without the last<br /> period and everything after it.</p>||FALSE|FALSE|FALSE|FALSE|FALSE|131|139|function getFileName_(fileName) {   return fileName.replace(/\.[^/.]+$/, ""); }|function|getFileName_| |getFileName_()|
|returns|The file name without the extension.|<p>const folder = DriveApp.getFolderById("folderId");<br /> const convertedFolder = createConvertedFolder_(folder);</p>| |<p>The file name without the extension.</p>| ||FALSE|FALSE|FALSE|FALSE| | | | | | | | | | | | | | | |
|example|getFileName_("myFile.txt") // returns "myFile"|<p>getFileName_("myFile.txt") // returns "myFile"</p>| | | | | | | | | | | | | | | | | | | | | | | |
